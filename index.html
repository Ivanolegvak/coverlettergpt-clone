<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CoverLetterGPT ‚Äì Smart AI Letters</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom right, #f9fbff, #edf1f5);
      color: #333;
      margin: 0;
      padding: 2rem;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }
    h1 {
      font-size: 2.2rem;
      color: #2b2b2b;
    }
    .ukraine {
      color: #0057B8;
      font-weight: bold;
      background-color: #FFD700;
      padding: 0.25rem 0.75rem;
      border-radius: 6px;
    }
    textarea, input[type="text"] {
      width: 100%;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    .button, button {
      background-color: #0488cd;
      color: white;
      border: none;
      padding: 1rem 2rem;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      margin-bottom: 1rem;
    }
    #response {
      white-space: pre-wrap;
      background-color: #fff;
      padding: 1rem;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .pay-cta {
      margin-top: 2rem;
    }
    .upload-group {
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>‚úçÔ∏è CoverLetterGPT</h1>
    <div class="ukraine">üá∫üá¶ We Stand with Ukraine</div>
  </header>

  <p>Paste your resume, job description, or upload files/URLs to generate the perfect AI cover letter.</p>

  <h3>Resume Text:</h3>
  <textarea id="resume"></textarea>

  <h3>Job Description:</h3>
  <textarea id="job"></textarea>

  <h3>OR Paste a Job URL:</h3>
  <input type="text" id="jobURL" placeholder="https://company.com/job-posting">

  <div class="upload-group">
    <label><strong>Upload Resume (PDF or DOCX):</strong></label>
    <input type="file" id="resumeFile" accept=".pdf,.docx"><br><br>
    <label><strong>Upload Job Description (PDF or DOCX):</strong></label>
    <input type="file" id="jobFile" accept=".pdf,.docx">
  </div>

  <br><button onclick="generateLetter()">Generate Cover Letter</button>

  <div class="pay-cta">
    <a href="https://secure.wayforpay.com/button/ba044d1ef050b" class="button">üí≥ Unlock Unlimited Letters for $4.99</a>
  </div>

  <h3>Generated Cover Letter:</h3>
  <div id="response">Your cover letter will appear here.</div>

  <script>
    async function extractFromURL(url) {
      try {
        const res = await fetch('https://api.allorigins.win/get?url=' + encodeURIComponent(url));
        const data = await res.json();
        return data.contents;
      } catch (e) {
        return 'Unable to fetch content from job URL.';
      }
    }

    async function readFileContent(file) {
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onload = (e) => resolve(e.target.result);
        reader.readAsText(file);
      });
    }

    async function generateLetter() {
      const resumeText = document.getElementById("resume").value;
      const jobText = document.getElementById("job").value;
      const jobURL = document.getElementById("jobURL").value;

      let resume = resumeText;
      let job = jobText;

      if (jobURL) {
        job = await extractFromURL(jobURL);
      }

      const resumeFile = document.getElementById("resumeFile").files[0];
      const jobFile = document.getElementById("jobFile").files[0];

      if (resumeFile) {
        resume += '\n' + await readFileContent(resumeFile);
      }

      if (jobFile) {
        job += '\n' + await readFileContent(jobFile);
      }

      const response = await fetch("https://coverlettergpt-clone-production.up.railway.app/api/generate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ resume, job })
      });

      const data = await response.json();
      document.getElementById("response").textContent = data.result;
    }
  </script>
</body>
</html>
